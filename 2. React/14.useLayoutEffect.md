# React `useLayoutEffect` í•µì‹¬ ì •ë¦¬

## 1. ì •ì˜ (Definition)

> **"ë¸Œë¼ìš°ì €ê°€ í™”ë©´ì„ ê·¸ë¦¬ê¸°(Paint) ì „ì—, ë™ê¸°ì (Synchronous)ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í›…"**

- `useEffect`ì™€ ì‚¬ìš©ë²•ì€ 100% ë˜‘ê°™ìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ **ì‹¤í–‰ë˜ëŠ” íƒ€ì´ë°**ì´ ë‹¤ë¦…ë‹ˆë‹¤.
- **ì£¼ ëª©ì :** í™”ë©´ì´ ê¹œë¹¡ì´ëŠ” í˜„ìƒ(Flicker)ì„ ì œê±°í•˜ê±°ë‚˜, DOMì˜ í¬ê¸°/ìœ„ì¹˜ë¥¼ ì •í™•í•˜ê²Œ ì¸¡ì •í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

---

## 2. í•µì‹¬ ë™ìž‘ ì›ë¦¬: "ë™ê¸°(Blocking) ì‹¤í–‰"

### `useEffect`ì™€ `useLayoutEffect`ì˜ ë¹„êµ

#### ðŸ”„ `useEffect` (ë¹„ë™ê¸°)

1. ë¦¬ì•¡íŠ¸ê°€ DOMì„ ë°”ê¿ˆ.
2. **ë¸Œë¼ìš°ì €ê°€ í™”ë©´ì„ ê·¸ë¦¼ (Paint).** ðŸŽ¨ (ì‚¬ìš©ìžê°€ ë³€ê²½ëœ í™”ë©´ì„ ë´„)
3. ê·¸ ë’¤ì— `useEffect`ê°€ ì‹¤í–‰ë¨.
4. ë§Œì•½ ì—¬ê¸°ì„œ stateë¥¼ ë˜ ë°”ê¾¸ë©´? ðŸ‘‰ **í™”ë©´ì´ í•œ ë²ˆ ë” ê·¸ë ¤ì§€ë©´ì„œ ê¹œë¹¡ìž„ ë°œìƒ.**

#### ðŸ›‘ `useLayoutEffect` (ë™ê¸°)

1. ë¦¬ì•¡íŠ¸ê°€ DOMì„ ë°”ê¿ˆ.
2. **`useLayoutEffect` ì‹¤í–‰.**
3. ì´ ì•ˆì˜ ìž‘ì—…ì´ ëª¨ë‘ ëë‚œ ë’¤ì—ì•¼...
4. **ë¸Œë¼ìš°ì €ê°€ í™”ë©´ì„ ê·¸ë¦¼ (Paint).** ðŸŽ¨
5. **ê²°ê³¼:** ì‚¬ìš©ìžëŠ” ê¹œë¹¡ìž„ ì—†ì´ ìµœì¢…ì ìœ¼ë¡œ ì™„ì„±ëœ í™”ë©´ë§Œ ë´„.

---

## 3. ì–¸ì œ ì¨ì•¼ í•˜ë‚˜ìš”?

ëŒ€ë¶€ë¶„ì˜ ìƒí™©ì—ì„œëŠ” `useEffect`ë¥¼ ì“°ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤(ì„±ëŠ¥ ë•Œë¬¸). í•˜ì§€ë§Œ **ì•„ëž˜ 2ê°€ì§€ ìƒí™©ì—ì„œëŠ” `useLayoutEffect`ê°€ í•„ìˆ˜**ìž…ë‹ˆë‹¤.

### â‘  í™”ë©´ ê¹œë¹¡ìž„(Flicker) ì œê±°

- Stateê°€ ë°”ë€Œìžë§ˆìž DOM ìŠ¤íƒ€ì¼ì„ ìˆ˜ì •í•´ì•¼ í•˜ëŠ”ë°, `useEffect`ë¡œ í•˜ë©´ ì‚¬ìš©ìžê°€ **ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ê¸° ì „ì˜ ëª»ë‚œ í™”ë©´**ì„ ìž ê¹ ë³´ê²Œ ë  ë•Œ.

### â‘¡ DOM ìš”ì†Œì˜ í¬ê¸°/ìœ„ì¹˜ ì¸¡ì •

- ìš”ì†Œê°€ í™”ë©´ì— ë‚˜íƒ€ë‚˜ê¸° ì „ì— ë¯¸ë¦¬ ë†’ì´ë‚˜ ë„“ì´(`getBoundingClientRect`)ë¥¼ ìž¬ì„œ, ê·¸ì— ë§žì¶° ë ˆì´ì•„ì›ƒì„ ë‹¤ì‹œ ìž¡ì•„ì•¼ í•  ë•Œ.

---

## 4. ì½”ë“œ ì˜ˆì‹œ: ê¹œë¹¡ìž„ í•´ê²°í•˜ê¸°

**ìƒí™©:** ìˆ«ìžê°€ 0ì´ë©´ ìˆœì‹ê°„ì— ëžœë¤ ìˆ«ìžë¡œ ë°”ê¿”ì•¼ í•˜ëŠ” ë¡œì§.

### âŒ `useEffect` ì‚¬ìš© (ê¹œë¹¡ìž„ O)

```javascript
useEffect(() => {
  if (value === 0) {
    setValue(10 + Math.random() * 200);
  }
}, [value]);
```

> **ì‚¬ìš©ìž ê²½í—˜:** í™”ë©´ì— ì•„ì£¼ ì°°ë‚˜ì˜ ìˆœê°„ `0`ì´ ë³´ì˜€ë‹¤ê°€(Paint 1), ëžœë¤ ìˆ«ìžë¡œ ë°”ë€œ(Paint 2). ëˆˆì´ í”¼ê³¤í•¨.

### âœ… `useLayoutEffect` ì‚¬ìš© (ê¹œë¹¡ìž„ X)

```javascript
useLayoutEffect(() => {
  if (value === 0) {
    setValue(10 + Math.random() * 200);
  }
}, [value]);
```

> **ì‚¬ìš©ìž ê²½í—˜:** ë¸Œë¼ìš°ì €ê°€ í™”ë©´ì„ ê·¸ë¦¬ê¸° ì „ì— ê°€ë¡œì±„ì„œ ìˆ«ìžë¥¼ ë°”ê¿”ë²„ë¦¼. ì‚¬ìš©ìžëŠ” `0`ì„ ì ˆëŒ€ ë³´ì§€ ëª»í•˜ê³  ë°”ë¡œ ì™„ì„±ëœ ëžœë¤ ìˆ«ìžë§Œ ë´„.

---

## 5\. âš¡ï¸ useEffect vs useLayoutEffect ë¹„êµ

| êµ¬ë¶„          | useEffect                          | useLayoutEffect                           |
| :------------ | :--------------------------------- | :---------------------------------------- |
| **ì‹¤í–‰ ì‹œì ** | í™”ë©´ì´ ê·¸ë ¤ì§„ **í›„** (Paint After) | í™”ë©´ì´ ê·¸ë ¤ì§€ê¸° **ì „** (Paint Before)     |
| **ë°©ì‹**      | **ë¹„ë™ê¸°** (ê¸°ë‹¤ë ¤ì£¼ì§€ ì•ŠìŒ)       | **ë™ê¸°** (ëë‚  ë•Œê¹Œì§€ í™”ë©´ ë Œë”ë§ì„ ë§‰ìŒ) |
| **ì£¼ ìš©ë„**   | ë°ì´í„° í†µì‹ (API), ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“± | DOM ì¸¡ì •, ë ˆì´ì•„ì›ƒ ë³´ì •, ê¹œë¹¡ìž„ ë°©ì§€      |
| **ì„±ëŠ¥ ì˜í–¥** | ì¢‹ìŒ (í™”ë©´ ë Œë”ë§ ë°©í•´ ì•ˆ í•¨)      | **ë‚˜ì¨** (ìž‘ì—…ì´ ê¸¸ì–´ì§€ë©´ í™”ë©´ì´ ëŠ¦ê²Œ ëœ¸) |

> **ðŸ’¡ ê²°ë¡  ê°€ì´ë“œ**
>
> 1.  ì¼ë‹¨ \*\*`useEffect`\*\*ë¡œ ì½”ë“œë¥¼ ì§ ë‹¤.
> 2.  ì‹¤í–‰í•´ë´¤ëŠ”ë° **"ì–´? í™”ë©´ì´ ë¯¸ì„¸í•˜ê²Œ ê¹œë¹¡ê±°ë¦¬ë„¤? ìœ„ì¹˜ê°€ íŠ€ë„¤?"** í•˜ëŠ” ëŠë‚Œì´ ë“ ë‹¤.
> 3.  ê·¸ë•Œë§Œ \*\*`useLayoutEffect`\*\*ë¡œ ë°”ê¾¼ë‹¤.
